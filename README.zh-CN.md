# é¢å‘åˆ†æ—¶ç”µä»·çš„ä¸ªæ€§åŒ–å®¶åº­ç”¨èƒ½ç­–ç•¥ä¼˜åŒ–æ™ºèƒ½ä½“
åŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„å®¶ç”µè°ƒåº¦ä¸ç”µè´¹ä¼˜åŒ–æ™ºèƒ½ä½“ã€‚


##  é¡¹ç›®ä»‹ç»

- ä¸ªæ€§åŒ–æ„ŸçŸ¥ï¼šè¯†åˆ«æ¯ä¸ªå®¶åº­çš„ç”µå™¨æ„æˆã€åŠŸç‡ç‰¹å¾ä¸ä½¿ç”¨ä¹ æƒ¯ã€‚
- è¯­ä¹‰ç†è§£ï¼šä»è‡ªç„¶è¯­è¨€ä¸­æŠ½å–è°ƒåº¦è¯‰æ±‚ä¸çº¦æŸè§„åˆ™ã€‚
- ç”µä»·æ„ŸçŸ¥ï¼šé€‚é…å¹¶åˆ©ç”¨ Economy 7/10 ç­‰åˆ†æ—¶ç”µä»·ï¼ˆToUï¼‰æ¨¡å‹ã€‚
- è°ƒåº¦ä¼˜åŒ–ï¼šåœ¨å¤šé‡çº¦æŸä¸‹ç”Ÿæˆå¯æ‰§è¡Œã€ä½æˆæœ¬çš„è¿è¡Œè®¡åˆ’ã€‚

æœ¬é¡¹ç›®å°† LLM ä¸å¯å‘å¼è°ƒåº¦ä¼˜åŒ–ç»“åˆï¼Œå›´ç»•â€œæ„ŸçŸ¥â€”ç†è§£â€”æ¨ç†â€”ä¼˜åŒ–â€å››é˜¶æ®µæ„å»ºé—­ç¯è°ƒåº¦æµç¨‹ï¼Œå¹¶å®ç°äº†å®Œæ•´çš„ Agent æ§åˆ¶é€»è¾‘ä¸æ¨¡å—åŒ–å·¥å…·é“¾ï¼Œé€‚ç”¨äºï¼š

-  å­¦æœ¯ç ”ç©¶ï¼šç”µä»·å“åº”è°ƒåº¦ã€è¯­ä¹‰çº¦æŸå»ºæ¨¡ã€NILM è¯†åˆ«ã€å¤šæ™ºèƒ½ä½“ä¼˜åŒ–ï¼›
-  æ™ºèƒ½å®¶å±…åŸå‹ï¼šé›†æˆå®¶åº­ç”µå™¨è¿›è¡Œç«¯ä¾§è°ƒåº¦ï¼›
-  èŠ‚èƒ½å¹³å°/è¡Œä¸šåµŒå…¥ï¼šæ¨¡å—æ¥å£æ¸…æ™°ï¼Œæ”¯æŒå¤šæˆ·/å¤šç”µä»·å¹¶è¡Œæµ‹è¯•ã€‚

æ„ŸçŸ¥ï¼šåŸºäº NILMï¼ˆå¦‚ REFITï¼‰åˆ†é’Ÿçº§æ•°æ®ï¼Œå¯¹æ€»åŠŸç‡ä¸åˆ†ç”µå™¨åŠŸç‡å¯¹é½ã€å»å™ªã€ç»Ÿä¸€ç²’åº¦ï¼Œå¹¶æå–ç”µå™¨è¿è¡Œäº‹ä»¶æ®µï¼ˆèµ·æ­¢æ—¶é—´ã€åŠŸç‡ã€èƒ½è€—ï¼‰ã€‚

ç†è§£ï¼šåˆ©ç”¨ LLMï¼ˆå¦‚ GPTï¼‰ä»ç”¨æˆ·è¾“å…¥ä¸­è¯†åˆ«ç”µå™¨åç§°ã€ä½¿ç”¨è¯­å¢ƒä¸åå¥½çº¦æŸï¼Œç”Ÿæˆç»“æ„åŒ–è°ƒåº¦è§„åˆ™ï¼ˆå¦‚ç¦æ­¢æ—¶æ®µã€æœ€æ™šå®Œæˆæ—¶é—´ã€åç§»æ–¹å‘ï¼‰ã€‚

æ¨ç†ï¼šç»“åˆç”¨æˆ·è§„åˆ™ä¸ç”µä»·æ¨¡å‹ï¼Œåˆ¤æ–­äº‹ä»¶å¯è½¬ç§»æ€§ï¼Œæ„å»ºå¤šç»´è¿è¡ŒåŒºé—´ä¸è°ƒåº¦ç©ºé—´ï¼Œé¢„æµ‹è½¬ç§»å‰åçš„æˆæœ¬å½±å“ã€‚

ä¼˜åŒ–ï¼šé‡‡ç”¨å¯å‘å¼æœç´¢åœ¨å¯è¡ŒåŒºé—´å†…é€‰æ‹©æ»¡è¶³çº¦æŸä¸”ç”µä»·æœ€ä½çš„æ—¶é—´ç‚¹ï¼Œç”Ÿæˆå¯æ‰§è¡Œçš„äº‹ä»¶æ—¥ç¨‹ï¼Œå¹¶å¯¹åŸå§‹/ä¼˜åŒ–æ–¹æ¡ˆè¿›è¡Œè´¹ç”¨å¯¹æ¯”ä¸èŠ‚èƒ½è¯„ä¼°ã€‚


##  æ•°æ®é›†ï¼šREFITï¼ˆæŒ‰ç”µå™¨çº§åˆ«ï¼‰

æœ¬é¡¹ç›®ä½¿ç”¨è‹±å›½æ‹‰å¤«å ¡å¤§å­¦æä¾›çš„å…¬å¼€æ•°æ®é›† **REFIT** ä½œä¸ºä¸»è¦å®éªŒæ•°æ®ï¼Œå…¶ç‰¹ç‚¹åŒ…æ‹¬ï¼š
- è®°å½•äº† 2013â€“2015 å¹´é—´ 20 æˆ·å®¶åº­çš„åˆ†é’Ÿçº§ç”µå™¨åŠŸç‡ã€‚
- è¦†ç›–å†°ç®±ã€æ´—è¡£æœºã€å¹²è¡£æœºã€ç”µè§†ç­‰ä¸»è¦å®¶ç”µã€‚
- æ¯æˆ·åŒ…å«æ€»åŠŸç‡ï¼ˆAggregateï¼‰åŠå¤šä¸ªåˆ†ç”µå™¨é€šé“ã€‚
- é€‚ç”¨äº NILMã€ç”µä»·å“åº”ã€è°ƒåº¦ä¼˜åŒ–ç­‰ç ”ç©¶ã€‚

 æ•°æ®é›†é“¾æ¥ï¼š[REFIT Dataset](https://pureportal.strath.ac.uk/en/projects/personalised-retrofit-decision-support-tools-for-uk-homes-using-s/datasets/)

åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œæ•°æ®ç»è¿‡å¤šåˆ†è¾¨ç‡å¯¹é½ã€å¼‚å¸¸å»é™¤ä¸è¡Œä¸ºå»ºæ¨¡ï¼Œä½œä¸º Agent çš„è¾“å…¥åŸºç¡€ã€‚

---

##  ç³»ç»Ÿæ¶æ„ä¸å·¥ä½œæµ

ç«¯åˆ°ç«¯æµç¨‹ï¼ˆé›†æˆ Runnerï¼‰ï¼š
- `test_func_2_int.py` â€” æ„ŸçŸ¥å¯¹é½ã€äº‹ä»¶åˆ†å‰²ã€å¯è½¬ç§»æ€§ã€äº‹ä»¶ ID
  - ä½¿ç”¨ï¼štools/p_01_perception_alignment.py, tools/p_02_segment_events.py, tools/p_02_shiftable_identifier.py, tools/p_02_event_id.py
- `test_func_3_int.py` â€” ç”µä»·å»ºæ¨¡ä¸åŸºçº¿æˆæœ¬åˆ†æ
  - ä½¿ç”¨ï¼štools/p_03_tariff_modeling.py, tools/p_03_energy_summary.py
- `test_func_4_int.py` â€” ç”µå™¨æ¸…å•æ ‡å‡†åŒ–ä¸æ±‡æ€»
  - ä½¿ç”¨ï¼štools/p_041_get_appliance_list.py
- `test_func_5_int.py` â€” ç”¨æˆ·çº¦æŸï¼ˆè‡ªç„¶è¯­è¨€â†’JSONï¼‰ã€æœ€å°æ—¶é•¿è¿‡æ»¤ã€TOU ä¼˜åŒ–
  - ä½¿ç”¨ï¼štools/p_042_user_constraints.py, tools/p_043_min_duration_filter.py, tools/p_044_tou_optimization_filter.py
- `test_func_6_int.py` â€” è°ƒåº¦ç©ºé—´ã€äº‹ä»¶è°ƒåº¦ã€å†²çªæ¶ˆè§£ã€äº‹ä»¶æ‹†åˆ†
  - ä½¿ç”¨ï¼štools/p_051_appliance_space_generator.py, tools/p_052_event_scheduler.py, tools/p_053_collision_resolver.py, tools/p_054_event_splitter.py
- `test_func_7_int.py` â€” æœ€ç»ˆæˆæœ¬è®¡ç®—ä¸æ±‡æ€»
  - ä½¿ç”¨ï¼štools/p_061_cost_cal.py
- ç»˜å›¾ CLI â€” æŒ‰æˆ·çš„æœˆåº¦è¶‹åŠ¿
  - ä½¿ç”¨ï¼štools/plot_monthly_cost_comparison.py

ç»Ÿä¸€çš„äº¤äº’å¼å…¥å£ï¼š`main_personal_household_tariff_scheduling_AI_agent.py`ã€‚
å„ `test_func_*` å¯ç‹¬ç«‹è¿è¡Œä»¥ä¾¿å®éªŒã€‚

---

##  å¿«é€Ÿå¼€å§‹

###  ç¯å¢ƒå‡†å¤‡
```bash
pip install -r requirements.txt
conda activate your_env_name
```

###  å¯åŠ¨ Agent
```bash
export open_api_key=your_api_key
python main_personal_household_tariff_scheduling_AI_agent.py
```
ä½“éªŒå®Œæ•´å¯¹è¯æµç¨‹ï¼šç”µå™¨è¯†åˆ«ã€ç”µä»·åˆ†æã€è°ƒåº¦ä¸èŠ‚èƒ½åé¦ˆã€‚

---

##  ç”¨æˆ·å¯é…é¡¹ï¼ˆåŸºç¡€è®¾ç½®ï¼‰

| æ–‡ä»¶/ä½ç½® | è¯´æ˜ |
| :--- | :--- |
| `settings.py` | è®¾ç½® LLM å‡­è¯ä¸ç«¯ç‚¹ï¼š`ai_easy_api_key`, `llm_url`, `llm_model4mini`, `http_timeout` |
| `config/house_appliances.json` | å®šä¹‰å„æˆ·ç”µå™¨ï¼ˆREFITï¼‰ã€‚ç”¨äºè‡ªæœ‰æ•°æ®æ—¶å¯åœ¨æ­¤å¢æ”¹ç”µå™¨åç§° |
| `config/tariff_config.json` | é…ç½®/æ‰©å±•ç”µä»·æ–¹æ¡ˆï¼ˆUK/Economy7/10ã€TOU_Dã€Germanyï¼‰ |
| `tools/p_01_perception_alignment.py` | è°ƒæ•´é¢„å¤„ç†/å¯¹é½é˜¶æ®µçš„è¾“å…¥æ•°æ®è·¯å¾„ï¼ŒæŒ‡å‘ä½ çš„åŸå§‹ CSV |
| `main_personal_household_tariff_scheduling_AI_agent.py` | åœ¨å¯¹è¯å…¥å£æä¾›åˆå§‹æç¤ºï¼ˆå¦‚ `house1, uk, single`ï¼‰ä»¥é©±åŠ¨ç«¯åˆ°ç«¯æµç¨‹ |
| `test_func_*.py`ï¼ˆå¯é€‰ï¼‰ | åˆ†æ­¥éª¤è°ƒè¯•å„é˜¶æ®µ |

---

##  ç”¨æˆ·çº¦æŸè®¾ç½®ï¼ˆå¯é€‰æ‰©å±•ï¼‰

| æ–‡ä»¶/ä½ç½® | è¯´æ˜ |
| :--- | :--- |
| `config/appliance_constraints.json` | å­˜å‚¨ LLM è§£æåçš„ç»“æ„åŒ–è§„åˆ™ï¼ˆå¯é¢„ç½®é»˜è®¤ï¼Œæˆ–ç”±ç³»ç»Ÿè‡ªåŠ¨å†™å…¥ï¼‰ |
| `main_personal_household_tariff_scheduling_AI_agent.py` | åœ¨å¯¹è¯ä¸­ç»™å‡ºè‡ªç„¶è¯­è¨€è§„åˆ™ï¼Œä¾‹å¦‚ï¼šâ€œWashing Machine 23:00â€“06:30 ç¦æ­¢ï¼›æ¬¡æ—¥ 14:00 å‰å¿…é¡»å®Œæˆâ€ã€‚ç³»ç»Ÿå°†è§£æå¹¶åº”ç”¨ |

ç³»ç»Ÿä¼šè°ƒç”¨ GPT å°†å…¶ç»“æ„åŒ–ä¸ºè§„åˆ™è¡¨ï¼Œå¹¶æ®æ­¤å¯¹è¿è¡Œäº‹ä»¶è¿›è¡Œè¿‡æ»¤ä¸å¯è¡Œè½¬ç§»ã€‚

---

##  æ¨èå®éªŒæ­¥éª¤

1. æ‰“å¼€ `config/house_appliances.json`ï¼Œé€‰æ‹©ä¸€ä¸ªå®¶åº­ï¼ˆå¦‚ `house1`ï¼‰ã€‚
2. è¿è¡Œäº¤äº’å¼å…¥å£ï¼š
   ```bash
   python main_personal_household_tariff_scheduling_AI_agent.py
   ```
   åœ¨å¯¹è¯ä¸­ç»™å‡ºåˆå§‹æç¤ºï¼š
   ```
   house1, uk, single
   ```
3. åœ¨ `output/` ä¸‹æŸ¥çœ‹ç»“æœï¼š

| è·¯å¾„ | è¯´æ˜ |
| :--- | :--- |
| `01_preprocessed/` |  åŸå§‹æ•°æ®å¯¹é½/æ¸…æ´—/é‡é‡‡æ · |
| `02_behavior_modeling/` |  ç”µå™¨è¯­ä¹‰ä¸å¯è½¬ç§»æ€§ï¼ˆLLM è¾…åŠ©ï¼‰ |
| `02_event_segments/` |  åˆ†ç”µå™¨äº‹ä»¶æ®µï¼ˆèµ·æ­¢ã€æ—¶é•¿ã€èƒ½è€—ï¼‰ |
| `03_cost_analysis/` |  åŸºçº¿å¤šç”µä»·æˆæœ¬åˆ†æä¸å¯¹æ¯” |
| `04_user_constraints/` |  ç”¨æˆ·è§„åˆ™è§£æç»“æœï¼ˆNLâ†’JSONï¼‰ |
| `04_min_duration_filter/` |  æœ€å°æ—¶é•¿å¯è¡Œæ€§è¿‡æ»¤ |
| `04_TOU_filter/` |  TOU ä¼˜åŒ–è¿‡æ»¤åçš„å¯è¡Œçª—å£ |
| `05_appliance_working_spaces/` |  ç”Ÿæˆçš„è°ƒåº¦ç©ºé—´ |
| `05_Initial_scheduling_optimization/` |  å†²çªå‰çš„åˆå§‹è°ƒåº¦æ–¹æ¡ˆ |
| `05_Collision_Resolved_Scheduling/` |  å†²çªæ¶ˆè§£åçš„è°ƒåº¦æ–¹æ¡ˆ |
| `05_event_split/` |  å¿…è¦æ—¶çš„äº‹ä»¶æ‹†åˆ† |
| `05_scheduling/` |  æœ€ç»ˆè°ƒåº¦ç»“æœ |
| `06_cost_cal/` |  è°ƒåº¦åçš„æœ€ç»ˆæˆæœ¬è®¡ç®— |
| `Monthly_cost_trends/` |  å„æˆ·çš„æœˆåº¦å¯¹æ¯”å›¾ |

---

##  å¯è§†åŒ–ç¤ºä¾‹

| ä¸åŒåˆ†æ®µç”µä»·ä¸‹çš„æ€»è´¹ç”¨ä¸æ¨èæ–¹æ¡ˆ |
| ![](output/07_cost_analysis/comparison.png)

| æœˆåº¦æˆæœ¬è¶‹åŠ¿ | å„ç”µå™¨æˆæœ¬å¯¹æ¯” |
| ![](output/Monthly_cost_trends/house1/monthly_cost_comparison.png) | ![](output/Monthly_cost_trends/house1/appliance_cost_comparison.png) |

---

## ğŸ“ æ¨¡å—ä¸å·¥å…·æ„æˆ

###  ä¸»è¦å·¥å…·æ¨¡å—ï¼ˆéƒ¨åˆ†ï¼‰

| æ¨¡å—è·¯å¾„ | åŠŸèƒ½è¯´æ˜ |
| :--- | :--- |
| `tools/p_01_perception_alignment.py` | åŸå§‹åŠŸç‡æ•°æ®å¯¹é½/æ¸…æ´—/é‡é‡‡æ · |
| `tools/p_02_shiftable_identifier.py` | LLM è¾…åŠ©çš„ç”µå™¨è¯­ä¹‰ä¸å¯è½¬ç§»æ€§æ¨æ–­ |
| `tools/p_02_segment_events.py` | äº‹ä»¶æŠ½å–ï¼ˆèµ·æ­¢/æ—¶é•¿/èƒ½è€—ï¼‰ä¸åŸºç¡€ç‰¹å¾ |
| `tools/p_03_tariff_modeling.py` | å¤šç”µä»·æˆæœ¬ä»¿çœŸä¸åŸºçº¿å¯¹æ¯” |
| `tools/p_03_energy_summary.py` | æŒ‰æ—¶é—´ä¸æŒ‰ç”µå™¨çš„èƒ½è€—/è´¹ç”¨æ±‡æ€» |
| `tools/p_041_get_appliance_list.py` | ç”µå™¨æ¸…å•ä¸ ID æ˜ å°„å·¥å…· |
| `tools/p_042_user_constraints.py` | è‡ªç„¶è¯­è¨€ â†’ è§„åˆ™ JSON |
| `tools/p_043_min_duration_filter.py` | æœ€å°æ—¶é•¿å¯è¡Œæ€§è¿‡æ»¤ |
| `tools/p_044_tou_optimization_filter.py` | TOU æ„ŸçŸ¥çš„å¯è¡Œçª—å£ä¼˜åŒ– |
| `tools/p_051_appliance_space_generator.py` | ç”Ÿæˆç”µå™¨è¿è¡Œçš„è°ƒåº¦ç©ºé—´ |
| `tools/p_052_event_scheduler.py` | åœ¨å¯è¡Œç©ºé—´å†…å®‰æ’äº‹ä»¶ |
| `tools/p_053_collision_resolver.py` | è°ƒåº¦å†²çªæ¶ˆè§£ |
| `tools/p_054_event_splitter.py` | å¯é€‰çš„è°ƒåº¦åäº‹ä»¶æ‹†åˆ† |
| `tools/p_061_cost_cal.py` | æœ€ç»ˆæˆæœ¬è®¡ç®—ä¸æŠ¥è¡¨ |
| `tools/plot_monthly_cost_comparison.py` | æœˆåº¦è¶‹åŠ¿ç»˜å›¾ CLI |
| `tools/llm_proxy.py` | GPT API åŒ…è£…å™¨ï¼ˆè§£æè‡ªç„¶è¯­è¨€çº¦æŸï¼‰ |

###  Agent ä¸»æ§é€»è¾‘
- `main_personal_household_tariff_scheduling_AI_agent.py`ï¼šç»Ÿä¸€çš„äº¤äº’å¼å…¥å£ï¼Œç¼–æ’å…¨æµç¨‹ã€‚
- `test_func_*.py`ï¼šå¯é€‰çš„åˆ†æ¨¡å— Runnerï¼Œä¾¿äºèšç„¦è°ƒè¯•ã€‚

---

##  å¼•ç”¨ä¸è®¸å¯
æœ¬é¡¹ç›®ä»¥ MIT è®¸å¯å¼€æºï¼Œæ¬¢è¿å¼•ç”¨ä¸è´¡çŒ®ï¼š

```bibtex
@project{TariffSchedulingAgent,
  title={A Personalized AI Agent for Residential Energy Strategy Optimization under Time-of-Use Tariffs},
  author={Zhiqiang Chen},
  year={2025},
  url={https://github.com/Andychen2018/Personalized-AI-Agent-for-Residential}
  }
```

